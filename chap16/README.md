# Chap16 ネットワークフロー

## グラフの連結度

### 辺連結度

s,tに関する辺連結度：sからtに対して互いに辺を共有しない（辺素）s-tパスの最大本数
c(S, T): カットセットに含まれる辺の本数

- 最小カット問題

  - 有向グラフと2頂点s,tが与えられた時に、s-tカットのうち容量が最小なものを求める
    （グラフ上で最小本数の辺を取り除くことで、s-t間を分断する）

  - **辺素なs-tパスの最大本数 = s-tカットの最小容量**

- 辺連結度を求めるアルゴリズム
  - f <- 0 （パスの本数）
  - **残余グラフ**G'を元のグラフGで初期化
  - while G'においてs-tパスPが存在するならば：
    - f += 1
    - G'をPに関する残余グラフに更新
  - fが辺連結度

## 最大流問題と最小カット問題

### 最大流問題

sからtへできるだけ多くの容量を運ぶ方法を求める

```
c(e): 各辺eに与えられる運べる容量
x(e): 各辺eの流量を表す（許容）フロー
```
- $0 \leq x(e) \leq c(e)$
- 任意の中間頂点vにおいて、vに入るx(e)の総和とvから出るx(e)の総和が等しい

総流量：頂点sから出ていくx(e)の総和
最大フロー：総流量が最大のフロー
最大流問題：最大フローを求める

頂点集合Sをどのように取っても、Sから出ていく流量からSに入ってくる流量を引いた値は一定

### 最大流最小カット定理

**最大フローの総流量 = s-tカットの最小容量**

### フォード・ファルカーソン法（実装例：[16-1.py](code/16-1.py)）

容量c(e)の辺e=(u, v)にx(e)のフローが流れた時、

- u->vにはさらにc(e)-x(e)の流量を流せる
- v->uには最大x(e)の流量を押し戻せる

**残余グラフ**として、

- uからvにはc(e)-x(e)の容量を持つ辺を張る
- vからuへの辺e'が存在しない場合：
  - 容量x(e)の辺を張る
- e'が存在する場合：
  - 容量c(e')+x(e)の辺を張る

残余グラフ上にs-tパスPがなくなるまで、s-tパスを1本見つけてフローを流す
- Pに含まれる容量の最小値のフローを流す

## 応用例

- 二部マッチング
  - 新たに点s,tを用意
  - 辺を有向にし、容量を1とする
  - s-t間に最大流を流し、s,tを取り払うと最大サイズの二部マッチングが求まる
- 点連結度
  - 各頂点を2頂点に分裂させる
- プロジェクト選択問題